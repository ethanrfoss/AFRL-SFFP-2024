
%% Order Reduction Tests:

% Square Prop:
% G = [0.29116682622261064183888379375276,  -0.15631518027982918561669123391766,   -0.014124778930868877799276184248356, 0.0034926020176865787969511245592003, -0.010554690505019741555980949954119, -0.0026805944631054508080214571208444, 0.00021932490670899766746146375417936,  -0.0003039696001140967788513302938469,   -0.00005734345819422538245192788597393, -0.0000054055898187640581104116029032003;
%      -1.2035594745783415593365361928591,  -0.31120232306505929420481493252737,    0.032200028661833683674142747577207, -0.004030347125589637743980908624053, 0.0014860361838231375252589172575313, 0.00055664040406104759763084022239354, 0.00031765067300616435736274056900186, -0.00059485935522614612376568477003502,    0.00014474117646063564294675596322293,  0.0000010519425277138114363929648209517;
%      -0.78745467676781688570741835064837,  -0.27233297916410914574214530148311, -0.00084630793230711196407228813498591, 0.0063952057081843602728832287596106, 0.0076403306429780751610203459733839, -0.0011565582635596682523071443426943,  0.0002878105451839154792920139058765, -0.00050663607168994855261406895508003, -0.0000022626699431644043067628387089218, -0.0000024878381787891119110661761887338;
%      0.37145630597528073169044660062355, -0.094828692184951282606597544599936,    0.056515306280238063185716868019881, -0.011484728947676192331583955308361, 0.0099809580557128161487634443460593,  0.0010013293896329869200889639557772,  0.0005164451144960806186837154463376, -0.00023449843451677586229388305927301,    0.00023244145485815234306037346811991,  0.0000018958811259597852729873092986201];
% 
% E = [0,   0,   0,   0, 1.0, 1.0, 1.0, 2.0, 2.0, 3.0
%      0, 1.0, 2.0, 3.0,   0, 1.0, 2.0,   0, 1.0,   0];

% Elip Prop:
% G = [ 0.29116682622261064183888379375276, -0.010554690505019741555980949954119, -0.49107862201167545856961282879638,   0.052085309930239451214895041175623, 0.80779195484788823833355309034232, -0.042838450343299541711594713433442, -0.39862935163656465498149827908492,  -0.0003039696001140967788513302938469, -0.0084213358725455603887022348885694,  -0.13640592059743422703732562695222,  0.055410169060484903980068338569254,  0.44875749142102761002348643160076,  -0.10937528968489343417225256871461,  -0.59135294689323103511924273334444,  0.089957570037037304366833723179298,  0.36727989546957984234865079997689, -0.027745175910901483107284803963921, -0.091858192215776762745704786539136, -0.0000054055898187640581104116029032003,   -0.00018014978699441188520445622511801, 0.0022446766141222731366644538297805, 0.11036692614690139790933898211733, -0.018264267561605613404696057955334, -0.54332283299199890524988632023451, 0.054599080471572712658367976246154,  1.1610555023693474030466177282506, -0.082800534148680424162414226429973, -1.3691775718486591806311025720788, 0.069307338572702201218156403683679, 0.93837749790143198946879010691191, -0.030862553838368105008083119855655, -0.35454051970352995493129810711253, 0.0057891184705491319922865400826595,  0.057923320854074630825714109505498;
%       -1.2035594745783415593365361928591, 0.0014860361838231375252589172575313, -0.97767093192126763856464322088868, -0.0073332946300194374114611584047907,  1.6082042220845462754397203752887, 0.0060313930795770657675158865629328, -0.79361697340680625867292974362499, -0.00059485935522614612376568477003502,  0.0017487374040894415865715627589339,   0.32367257110640651474042783775076, -0.011506230919833821194075973437521,  -1.0648400774345656571995277772658,  0.022712389465268465610359172046628,    1.3996847881944596281300619011745, -0.018680191585472433191128516227764,  -0.8584963446599576109008467028616, 0.0057614406589115967766145942619005,   0.20940762589268294147082372091973,  0.0000010519425277138114363929648209517,    0.00045471781664067683834118405172831, 0.0031195130954088101660204301879276, -0.1302019238854491001156077345513, -0.025695392600127299476131526034806,  0.63919871681536977181536940406659, 0.076941943779744156883815264791338,  -1.364868014563902276492513010453,  -0.11684869430207081575368022186012,  1.6068217363247085938127156623523, 0.098212745321834465928034774151456, -1.0975711317168705960511942976154,  -0.04410480000321133353669011967213,  0.41242863546333141666622168486356, 0.0083844439096114175419272029898821, -0.066841595041927728826358645619621;
%      -0.78745467676781688570741835064837, 0.0076403306429780751610203459733839,  -0.8555592866721875022761878426536,  -0.037703520469857150498871334320938,  1.4073386168554489206172775084269,  0.031009902630488733049629601623565, -0.69449377033697734518113975354936, -0.00050663607168994855261406895508003, -0.0036334349442476215549802098792043, -0.003352426890473365981432118942962,  0.023907043677878797582891934325744, 0.011029042397515415735442800837518, -0.047190612700045611593857586285594, -0.015866622619281900430365794818499,  0.038812723232872797796133568226651, 0.013960275041072753993143251705078, -0.011970819501169516207994547585258, -0.005503825376672364690089356287217, -0.0000024878381787891119110661761887338, -0.0000071083872709437261825640361201373,  0.002877407191384962793778701239944, 0.19837336741407329832043160422472,  -0.02357484879565267116285909310136, -0.97888139842871857432271553989267, 0.070541037580256940597855930263904,  2.0932226454191913411762016039575,  -0.10706227170506456281007245934234, -2.4719714647016695074910330731655, 0.089825797554747677242659165131045,  1.6989958280269863433176169564831, -0.040191653615568131985291699947993, -0.64487329799027581778148032753961, 0.0075968086258151670819849243798672,   0.10606177007489042685151048317493;
%       0.37145630597528073169044660062355, 0.0099809580557128161487634443460593, -0.29791312271777081743806547819986,  -0.049254053776875750259023334365338, 0.49004744451959747486569085594965,  0.040509835493978733900188871075443, -0.24182872075866060357363096500194, -0.00023449843451677586229388305927301,  0.0031457690542945433362365115215198,   0.56009812237370615317644251263118, -0.020698330735384087852857248890359,  -1.8426489645404715567167386325309,  0.040856867224229986845784878823906,    2.4242026099542552941557005397044, -0.033603426380915311921793175997664,  -1.4934385835165961964321468258277,  0.010364141403148875719697485919824,   0.36753806150396567398175307062047,  0.0000018958811259597852729873092986201,    0.00073023636697209506549177682188656, 0.0050690415798945436670619457686371, -0.3645070180880838894843520847644, -0.041760449426639041636821758629594,   1.7934351604190506002112215355737,  0.12504969799820983555882492055389, -3.8318896801438939725414911663393,   -0.1899115820216565053701884835391,  4.5172562367380733050481467216741,  0.15963169161619725211487264004973, -3.0938860171789257513808024668833, -0.071694375457152889619116820085765,   1.1676794898737286043655103640049,  0.013631657234994130206695572837816,  -0.19046935104245368841624497235898];
% 
% E = [0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,    0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,    0,    0,    0,    0,    0,    0;
%      0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,    0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,    0,    0,    0,    0,    0,    0;
%      0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0,  2.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0,  3.0,  3.0,  3.0,  3.0,  3.0,  3.0;
%      0,   0, 1.0, 2.0, 3.0, 4.0, 5.0,   0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0,   0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0];

load('PZTest.mat');

pz = polyZonotope([0;0;0;0],PZ.G,[],PZ.E);

orders = 1:8;
colors = autumn(length(orders));
algs = {'pca','scott','girard','constOpt','valero'};
%algs = {'redistribute','methA','methC','combastel'};

for j = 1:length(algs)
    figure; title(algs{j}); hold on;
    plot(pz,[1,2],'Color',[0 0 0]);
    for i = 1:length(orders)
        pzs{i,j} = reduce(pz,algs{j},orders(i));
        % subplot(length(algs),1,j); hold on;
        plot(pzs{i,j},[1,2],'Color',colors(i,:));
    end
end